{% extends 'base_generic.html' %}
{% load static %}
{% load custom_filters %}

{% block content %}
<div id="gameplay-container" data-profile-id="{{ profile.id }}" data-debug="{{ debug }}">

  <div id="info-bar">

    <!-- Player info -->
    <div id="player-info" class="info-box">

      <div class="info-block left">
        <div class="info-line">
          <span>Player:</span>
          <span id="player-name" class="name-disp"></span>
        </div>
      </div>

      <div class="info-block right">
        <div class="info-line">
          <div class="level-info"><span>Level</span>
            <span id="player-level"></span>
          </div>
          <div class="xp-info"><span>XP:</span>
            <span id="player-xp"></span> / <span id="player-xp-next"></span>
          </div>
        </div>
      </div>

    </div>
    <!-- end of player info -->

    <!-- Character info -->
    <div id="character-info" class="info-box">

      <div class="info-block left">
        <div class="info-line">
          <span>Character:</span>
          <span id="character-name" class="name-disp"></span>
        </div>
      </div>

      <div class="info-block right">
        <div class="info-line">
          <div class="level-info"><span>Level</span>
            <span id="character-level"></span>
          </div>
          <div class="xp-info"><span>XP:</span>
            <span id="character-xp"></span> / <span id="character-xp-next"></span>
          </div>
        </div>
      </div>

    </div>
    <!-- end of character info -->

  </div>
  <!-- end of info-bar -->


  <div id="game-content">

    <!-- Activity -->
    <div id="activity-section" class="section-box">

      <div id="activity-top-bar" class="section-row section-top-bar justify-between">
        <div class="section-status">
          <span class="section-status-header">Activity:</span><span class="section-status-message"
            id="activity-status-text">waiting</span>
        </div>
        <div class="timer-frame">
          <span id="activity-timer" class="timer-text">00:00</span>
        </div>
      </div>

      <div id="current-activity-section" class="section-row current-item">
        
        <div id="activity-input-div" class="input-div">
          <input class="field-div" type="text" id="activity-input" placeholder="Enter activity" />    
        </div>

        <div id="activity-buttons" class="button-frame">
          <button class="button-filled" id="start-activity-btn">Start Activity</button>
          <button class="button-filled" id="stop-activity-btn" disabled="true" style="display: none;">Submit activity</button>
        </div>
        
      </div>


      <div id="today-activities" class="section-row list-section">
        <p class="list-section-header"><strong>Today's activities</strong></p>
        <div id="activity-totals">
          <span id="activities-time-message"></span>
          <span id="activities-time-data"></span>
          <span id="activities-total-message"></span>
          <span id="activities-total-data"></span>
        </div>
        <ul id="activity-list" class="list">
          Searching for activities completed today...
        </ul>
      </div>
    </div>
    <!-- End of activity section -->

    <!-- Quest -->
    <div id="quest-section" class="game-section">

      <div id="activity-top-bar" class="section-row section-top-bar justify-between">
        <div class="section-status">
          <span class="section-status-header">Quest:</span><span class="section-status-message"
            id="quest-status-text">waiting</span>
        </div>
        <div class="timer-frame">
          <span id="quest-timer" class="timer-text">00:00</span>
        </div>
      </div>

      <div id="current-quest-section" class="section-row current-item">
        <p id="quest-label" class="quest-text">
          <strong>Current quest:</strong> <span id="current-quest-title">None</span>
        </p>
        <p id="current-quest-intro" class="quest-text"></p>
        <p id="current-quest-outro" class="quest-text" style="display: none;"></p>
      </div>

      <div id="quest-stages" class="section-row list-section">
        <p id="quest-label" class="quest-text"><strong>Quest stages</strong></p>
        <div class="list-section" id="quest-previous-stages">
          <ul class="list" id="quest-stages-list" style="display:none">
            <!-- Quest stages dynamically loaded here -->
          </ul>
        </div>
      </div>



      <div id="quest-rewards" class="section-row list-section hidden">
        <h2 class="list-section-header">Quest rewards</h2>
        <ul class="list" id="quest-rewards-list">
        </ul>
      </div>

      <div class="button-frame" id="show-quests-btn-frame">
        <button class="button-filled" id="show-quests-btn">Show quests</button>
      </div>


      <!-- Modal for quest selection -->
      <div class="modal" id="quest-modal">
        <div class="modal-content">
          <button id="close-modal-btn" class="close-btn">x</button>

          <!-- Quest Categories and list-->
          <div class="quest-pane">
            <h2 id="quest-list-title">Available quests</h2>
            <ul id="quest-list-modal" class="quest-list list">
              <!-- Quests dynamically loaded here -->
            </ul>
          </div>

          <!-- Quest details -->
          <div class="details-pane">
            <h2 id="quest-title">No quest selected</h2>
            <p id="quest-description"></p>

            <div id="quest-rewards">
              <h3>Rewards:</h3>
              <div id="xp-reward" class="reward">
                <span class="reward-label">XP:</span>
                <span class="reward-value" id="xp-reward-value">0</span>
              </div>
              <div id="coin-reward" class="reward">
                <span class="reward-label">Coins:</span>
                <span class="reward-value" id="coin-reward-value">0</span>
              </div>
              <div id="other-rewards" class="reward">
                <ul class="list" id="other-rewards-list">
                  <!-- Other rewards dynamically loaded here -->
                </ul>
              </div>
            </div>

            <div id="choose-quest">
              <div>
                <label for="quest-durations">Select quest duration:</label>
                <select id="quest-durations">
                  <!-- options loaded dynamically here -->
                </select>
              </div>
              <div class="button-frame">
                <button class="button-filled" id="choose-quest-btn">Choose Quest</button>
              </div>
            </div>
            
          </div>

        </div>
      </div>
      <!-- End of modal-->


    </div>
    <!-- End of section Quest Display -->

  </div>
  <!-- End of section 'game-content' -->


</div>
<script src="{% static 'js/game.js' %}"></script>

{% endblock %}