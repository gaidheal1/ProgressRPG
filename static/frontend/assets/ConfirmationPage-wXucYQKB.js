import{c as u,u as l,a as g,r as m,j as a}from"./main-Bw56eorY.js";const h="http://localhost:8000",y=`${h}/api/v1`;function E(){const{key:o}=u(),n=l(),{login:i}=g(),[c,e]=m.useState("loading"),[d,s]=m.useState("");return m.useEffect(()=>{if(!o){e("error"),s("Invalid confirmation link.");return}if(sessionStorage.getItem("confirmedKey")===o){e("success"),s("Email already confirmed! Redirecting..."),setTimeout(()=>n("/onboarding"),2e3);return}async function f(){try{const r=await fetch(`${y}/auth/confirm_email/${encodeURIComponent(o)}/`),t=await r.json();r.ok?(e("success"),s("Email confirmed! Logging you in..."),t.access&&t.refresh&&i&&await i(t.access,t.refresh),sessionStorage.setItem("confirmedKey",o),setTimeout(()=>n("/onboarding"),2e3)):r.status===400&&t?.code==="already_confirmed"?(e("success"),s("Email already confirmed! Redirecting..."),setTimeout(()=>n("/onboarding"),2e3)):(e("error"),s(t?.message||"Confirmation failed."))}catch{e("error"),s("Something went wrong.")}}f()},[o,n,i]),a.jsxs("div",{children:[c==="loading"&&a.jsx("p",{children:"Just a moment..."}),c==="success"&&a.jsx("p",{style:{color:"green"},children:d}),c==="error"&&a.jsx("p",{style:{color:"red"},children:d})]})}export{E as default};
