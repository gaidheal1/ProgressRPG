import{c as u,u as l,a as g,r as m,j as a,A as y}from"./main-Dp8nAxGk.js";const h=`${y}/api/v1`;function E(){const{key:o}=u(),r=l(),{login:i}=g(),[c,e]=m.useState("loading"),[d,s]=m.useState("");return m.useEffect(()=>{if(!o){e("error"),s("Invalid confirmation link.");return}if(sessionStorage.getItem("confirmedKey")===o){e("success"),s("Email already confirmed! Redirecting..."),setTimeout(()=>r("/onboarding"),2e3);return}async function f(){try{const n=await fetch(`${h}/auth/confirm_email/${encodeURIComponent(o)}/`),t=await n.json();n.ok?(e("success"),s("Email confirmed! Logging you in..."),t.access&&t.refresh&&i&&await i(t.access,t.refresh),sessionStorage.setItem("confirmedKey",o),setTimeout(()=>r("/onboarding"),2e3)):n.status===400&&t?.code==="already_confirmed"?(e("success"),s("Email already confirmed! Redirecting..."),setTimeout(()=>r("/onboarding"),2e3)):(e("error"),s(t?.message||"Confirmation failed."))}catch{e("error"),s("Something went wrong.")}}f()},[o,r,i]),a.jsxs("div",{children:[c==="loading"&&a.jsx("p",{children:"Just a moment..."}),c==="success"&&a.jsx("p",{style:{color:"green"},children:d}),c==="error"&&a.jsx("p",{style:{color:"red"},children:d})]})}export{E as default};
